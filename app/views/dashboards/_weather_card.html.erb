<div class="col">
  <%= turbo_frame_tag "weather_card_#{location.id}" do %>
    <div class="card h-100 shadow-sm">
      <div class="card-header bg-primary text-white">
        <h5 class="mb-0"><%= location.name %></h5>
        <small>
          <i class="bi bi-geo"></i> <%= location.country || "N/A" %> |
          <i class="bi bi-clock"></i> <%= location.timezone %>
        </small>
        <% if location.elevation.present? %>
          <br>
          <small>
            <i class="bi bi-mountain"></i> Elevation: <%= location.elevation.round(0) %>m
          </small>
        <% end %>
      </div>
      <div class="card-body">
        <% metric = location.latest_weather %>

        <% if metric.present? %>
          <div class="row mb-3 text-center">
            <div class="col-6">
              <div class="p-2 bg-light rounded">
                <div style="font-size: 2em; font-weight: bold;">
                  <%= metric.temperature.round(1) %>°C
                </div>
                <small class="text-muted">Feels like <%= metric.feels_like&.round(1) %>°C</small>
              </div>
            </div>
            <div class="col-6">
              <div class="p-2 bg-light rounded">
                <div style="font-size: 1.5em; font-weight: bold;">
                  <%= metric.humidity %>%
                </div>
                <small class="text-muted">Humidity</small>
              </div>
            </div>
          </div>

          <div class="row mb-3 text-center">
            <div class="col-6">
              <div class="p-2 bg-light rounded">
                <div style="font-size: 1.5em; font-weight: bold;">
                  <%= metric.wind_speed.round(1) %> km/h
                </div>
                <small class="text-muted">Wind Speed</small>
              </div>
            </div>
            <div class="col-6">
              <div class="p-2 bg-light rounded">
                <div style="font-size: 1.5em; font-weight: bold;">
                  <%= metric.precipitation.round(1) %> mm
                </div>
                <small class="text-muted">Precipitation</small>
              </div>
            </div>
          </div>

          <div class="alert alert-info mb-0">
            <strong><%= metric.weather_description %></strong>
            <br>
            <small>
              <i class="bi bi-cloud"></i> Cloud Cover: <%= metric.cloud_cover %>% |
              <i class="bi bi-speedometer"></i> Pressure: <%= metric.pressure %>hPa
            </small>
          </div>

          <small class="text-muted d-block mt-2">
            Last updated: <%= time_ago_in_words(metric.recorded_at) %> ago
          </small>
        <% else %>
          <div class="alert alert-warning mb-0">
            No weather data available yet.
            <br><%= button_to "Fetch data", sync_weather_dashboards_path, method: :post, class: "btn btn-sm btn-primary mt-2" %>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>